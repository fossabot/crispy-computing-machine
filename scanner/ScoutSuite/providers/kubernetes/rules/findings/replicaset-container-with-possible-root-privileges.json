{
    "description": "Container/InitContainer/EphemeralContainer With Possible Root Privileges",
    "rationale": "Where possible, runAsNonRoot should be set to true to prevent the container from running as root.",
    "references": [
        "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/",
        "https://kubernetes.io/docs/concepts/policy/pod-security-policy/"
    ],
    "dashboard_name": "ReplicaSets",
    "path": "replica_set.v1-apps.resources.id.data.spec.template.spec.containers.id",
    "display_path": "replica_set.v1-apps.id",
    "id_suffix": "runAsNonRoot",
    "conditions": [
        "and",
        [
            "or",
            [
                "replica_set.v1-apps.resources.id.data.spec.template.spec.securityContext.runAsNonRoot",
                "null",
                ""
            ],
            [
                "replica_set.v1-apps.resources.id.data.spec.template.spec.securityContext.runAsNonRoot",
                "false",
                ""
            ]
        ],
        [
            "or",
            [
                "replica_set.v1-apps.resources.id.data.spec.template.spec.containers.id.securityContext.runAsNonRoot",
                "null",
                ""
            ],
            [
                "replica_set.v1-apps.resources.id.data.spec.template.spec.containers.id.securityContext.runAsNonRoot",
                "false",
                ""
            ]
        ]
    ]
}