{
    "description": "AppArmor Annotation Missing",
    "rationale": "The container.apparmor.security.beta.kubernetes.io annotation is missing. A compromised container with AppArmor disabled makes privilege escalation easier.",
    "references": [
        "https://kubernetes.io/docs/tutorials/security/apparmor/"
    ],
    "dashboard_name": "StatefulSets",
    "path": "stateful_set.v1-apps.resources.id",
    "display_path": "stateful_set.v1-apps.id",
    "conditions": [
        "or",
        [
            "stateful_set.v1-apps.resources.id.metadata",
            "withoutKey",
            "annotations"
        ],
        [
            "stateful_set.v1-apps.resources.id.metadata.annotations",
            "withoutKey",
            "container.apparmor.security.beta.kubernetes.io"
        ]
    ]
}